```{r}
#install.packages("tidyverse")
library(ggplot2)
library(lubridate)
```

```{r collect, eval=TRUE}
# clear memory
rm(list = ls())
# collecting the data
link='https://github.com/Data-Visual-Masters/Deliverable2/raw/main/Fremont_Bridge_Bicycle_Counter.csv'
fremont=read.csv(link)
```


Let's see what kind of data we have in **crime** data table:

```{r str, eval=TRUE}
# categorical? numerical?
str(fremont,width = 50,strict.width='cut')
```
```{r}
fremont$Date=as.Date(fremont$Date,format = "%m/%d/%Y")
```

```{r}
fremont$Fremont.Bridge.Total=as.numeric(fremont$Fremont.Bridge.Total)
```

```{r}
aggregate(data=fremont,Fremont.Bridge.Total~Date,FUN =sum )
```

```{r}
base=ggplot(fremont,
            aes(x=Date,y=Fremont.Bridge.Total))
base  + geom_line(alpha=0.3) 
```

```{r, eval=TRUE}
start <- as.Date("2020-1-1")
end <- NA
base=ggplot(fremont,
            aes(x=Date,y=Fremont.Bridge.Total))
base  + geom_line(alpha=0.3) + scale_x_date(limits = c(start, end)) 
```


```{r, eval=TRUE}
base=ggplot(fremont,
            aes(x=floor_date(Date, "month"),
                y=Fremont.Bridge.Total))
monthly= base  + geom_line(alpha=0.3) 
monthly= monthly + scale_x_date(limits = c(start, end))
monthly
```


```{r, eval=TRUE}
base=ggplot(fremont,
            aes(x=Date,
                y=Fremont.Bridge.Total))
monthly= base  + geom_line(alpha=0.3) 
monthly= monthly + scale_x_date(limits = c(start, end))
# adding a trend:
monthly = monthly + stat_smooth(color = "red",
                      method = "loess")
#monthly + facet_wrap(~crime)
monthly
```

```{r ggscatter, eval=TRUE}
library(ggrepel)
monthly + geom_text_repel(aes(label=Fremont.Bridge.Total))
```

```{r}
monthly + geom_text_repel(aes(label=Fremont.Bridge.Total),size=2,
                        min.segment.length = 0,
                        max.overlaps = 100)
```


Now we can limit the labels

```{r, eval=TRUE}
monthly + geom_text_repel(aes(label=ifelse(Fremont.Bridge.Total>=700,Fremont.Bridge.Total, "")),size=2,
                        min.segment.length = 0,
                        max.overlaps = 100)
```


